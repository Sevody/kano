<link rel="import" href="electron.html">
<link rel="import" href="base/downloader.html">
<link rel="import" href="base/connectors.html">
<link rel="import" href="base/bookmarks.html">
<link rel="import" href="base/chaptermarks.html">

<script>

    /**
     * Inverse of control container providing instances of all important engine modules.
     * Each module may depend on the corresponding underlying platform.
     */
    class Engine {

        /**
         *
         */
        static get Connectors() {
            if( !this._instanceConnectors ) {
                this._instanceConnectors = ( new Connectors() ).list;
            }
            return this._instanceConnectors;
        }

        /**
         *
         */
        static get DownloadManager() {
            if( !this._instanceDownloadManager ) {
                this._instanceDownloadManager = new DownloadManager();
            }
            return this._instanceDownloadManager;
        }

        /**
        *
        */
        static get BookmarkManager() {
            if( !this._instanceBookmarkManager ) {
                this._instanceBookmarkManager = new BookmarkManager();
            }
            return this._instanceBookmarkManager;
        }

        /**
        *
        */
        static get ChaptermarkManager() {
            if( !this._instanceChaptermarkManager ) {
                this._instanceChaptermarkManager = new ChaptermarkManager();
            }
            return this._instanceChaptermarkManager;
        }

        /**
         *
         */
        static get Request() {
            if( !this._instanceRequest ) {
                this._instanceRequest = new RequestElectron( Engine.Blacklist );
            }
            return this._instanceRequest;
        }

        /**
         *
         */
        static get Settings() {
            if( !this._instanceSettings ) {
                this._instanceSettings = new SettingsElectron();
            }
            return this._instanceSettings;
        }

        /**
         *
         */
        static get Storage() {
            if( !this._instanceStorage ) {
                this._instanceStorage = new StorageElectron();
            }
            return this._instanceStorage;
        }

        /**
         *
         */
        static get Blacklist() {
            if( !this._instanceBlacklist ) {
                this._instanceBlacklist = new Blacklist();
            }
            return this._instanceBlacklist;
        }
    }

    Engine.Settings.loadProfile( 'default', undefined );
    Engine.BookmarkManager.loadProfile( 'default', undefined );
    Engine.ChaptermarkManager.loadChaptermarks( undefined );

</script>